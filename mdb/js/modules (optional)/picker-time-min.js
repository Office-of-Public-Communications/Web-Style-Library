!function(){function t(t){return document.createElementNS(a,t)}function i(t){return(t<10?"0":"")+t}function e(t){var i=++m+"";return t?t+i:i}function s(s,c){function a(t,i){var e=l.offset(),s=/^touch/.test(t.type),o=e.left+v,a=e.top+v,p=(s?t.originalEvent.touches[0]:t).pageX-o,h=(s?t.originalEvent.touches[0]:t).pageY-a,k=Math.sqrt(p*p+h*h),m=!1;if(!i||!(k<f-g||k>f+g)){t.preventDefault();var b=setTimeout(function(){_.popover.addClass("clockpicker-moving")},200);r&&l.append(_.canvas),_.setHand(p,h,!i,!0),n.off(u).on(u,function(t){t.preventDefault();var i=/^touch/.test(t.type),e=(i?t.originalEvent.touches[0]:t).pageX-o,s=(i?t.originalEvent.touches[0]:t).pageY-a;(m||e!==p||s!==h)&&(m=!0,_.setHand(e,s,!1,!0))}),n.off(d).on(d,function(t){n.off(d),t.preventDefault();var e=/^touch/.test(t.type),s=(e?t.originalEvent.changedTouches[0]:t).pageX-o,r=(e?t.originalEvent.changedTouches[0]:t).pageY-a;(i||m)&&s===p&&r===h&&_.setHand(s,r),"hours"===_.currentView?_.toggleView("minutes",y/2):c.autoclose&&(_.minutesView.addClass("clockpicker-dial-out"),setTimeout(function(){_.done()},y/2)),l.prepend(j),clearTimeout(b),_.popover.removeClass("clockpicker-moving"),n.off(u)})}}var p=$(A),l=p.find(".clockpicker-plate"),k=p.find(".picker__holder"),m=p.find(".clockpicker-hours"),M=p.find(".clockpicker-minutes"),P=p.find(".clockpicker-am-pm-block"),C="INPUT"===s.prop("tagName"),x=C?s:s.find("input"),T=$("label[for="+x.attr("id")+"]"),_=this,V;if(this.id=e("cp"),this.element=s,this.holder=k,this.options=c,this.isAppended=!1,this.isShown=!1,this.currentView="hours",this.isInput=C,this.input=x,this.label=T,this.popover=p,this.plate=l,this.hoursView=m,this.minutesView=M,this.amPmBlock=P,this.spanHours=p.find(".clockpicker-span-hours"),this.spanMinutes=p.find(".clockpicker-span-minutes"),this.spanAmPm=p.find(".clockpicker-span-am-pm"),this.footer=p.find(".picker__footer"),this.amOrPm="PM",c.twelvehour){var H=['<div class="clockpicker-am-pm-block">','<button type="button" class="btn-floating btn-flat clockpicker-button clockpicker-am-button">',"AM","</button>",'<button type="button" class="btn-floating btn-flat clockpicker-button clockpicker-pm-button">',"PM","</button>","</div>"].join(""),S=$(H);c.ampmclickable?(this.spanAmPm.empty(),$('<div id="click-am">AM</div>').on("click",function(){_.spanAmPm.children("#click-am").addClass("text-primary"),_.spanAmPm.children("#click-pm").removeClass("text-primary"),_.amOrPm="AM"}).appendTo(this.spanAmPm),$('<div id="click-pm">PM</div>').on("click",function(){_.spanAmPm.children("#click-pm").addClass("text-primary"),_.spanAmPm.children("#click-am").removeClass("text-primary"),_.amOrPm="PM"}).appendTo(this.spanAmPm)):($('<button type="button" class="btn-floating btn-flat clockpicker-button am-button" tabindex="1">AM</button>').on("click",function(){_.amOrPm="AM",_.amPmBlock.children(".pm-button").removeClass("active"),_.amPmBlock.children(".am-button").addClass("active"),_.spanAmPm.empty().append("AM")}).appendTo(this.amPmBlock),$('<button type="button" class="btn-floating btn-flat clockpicker-button pm-button" tabindex="2">PM</button>').on("click",function(){_.amOrPm="PM",_.amPmBlock.children(".am-button").removeClass("active"),_.amPmBlock.children(".pm-button").addClass("active"),_.spanAmPm.empty().append("PM")}).appendTo(this.amPmBlock))}c.darktheme&&p.addClass("darktheme"),$('<button type="button" class="btn-flat clockpicker-button" tabindex="'+(c.twelvehour?"3":"1")+'">'+c.donetext+"</button>").click($.proxy(this.done,this)).appendTo(this.footer),this.spanHours.click($.proxy(this.toggleView,this,"hours")),this.spanMinutes.click($.proxy(this.toggleView,this,"minutes")),x.on("focus.clockpicker click.clockpicker",$.proxy(this.show,this));var B=$('<div class="clockpicker-tick"></div>'),D,E,I,O;if(c.twelvehour)for(D=1;D<13;D+=1)E=B.clone(),I=D/6*Math.PI,O=f,E.css("font-size","140%"),E.css({left:v+Math.sin(I)*O-g,top:v-Math.cos(I)*O-g}),E.html(0===D?"00":D),m.append(E),E.on(h,a);else for(D=0;D<24;D+=1){E=B.clone(),I=D/6*Math.PI;var z=D>0&&D<13;O=z?b:f,E.css({left:v+Math.sin(I)*O-g,top:v-Math.cos(I)*O-g}),z&&E.css("font-size","120%"),E.html(0===D?"00":D),m.append(E),E.on(h,a)}for(D=0;D<60;D+=5)E=B.clone(),I=D/30*Math.PI,E.css({left:v+Math.sin(I)*f-g,top:v-Math.cos(I)*f-g}),E.css("font-size","140%"),E.html(i(D)),M.append(E),E.on(h,a);if(l.on(h,function(t){0===$(t.target).closest(".clockpicker-tick").length&&a(t,!0)}),r){var j=p.find(".clockpicker-canvas"),L=t("svg");L.setAttribute("class","clockpicker-svg"),L.setAttribute("width",w),L.setAttribute("height",w);var U=t("g");U.setAttribute("transform","translate("+v+","+v+")");var N=t("circle");N.setAttribute("class","clockpicker-canvas-bearing"),N.setAttribute("cx",0),N.setAttribute("cy",0),N.setAttribute("r",2);var X=t("line");X.setAttribute("x1",0),X.setAttribute("y1",0);var Y=t("circle");Y.setAttribute("class","clockpicker-canvas-bg"),Y.setAttribute("r",g);var q=t("circle");q.setAttribute("class","clockpicker-canvas-fg"),q.setAttribute("r",5),U.appendChild(X),U.appendChild(Y),U.appendChild(q),U.appendChild(N),L.appendChild(U),j.append(L),this.hand=X,this.bg=Y,this.fg=q,this.bearing=N,this.g=U,this.canvas=j}o(this.options.init)}function o(t){t&&"function"==typeof t&&t()}var $=window.jQuery,c=$(window),n=$(document),a="http://www.w3.org/2000/svg",r="SVGAngle"in window&&function(){var t,i=document.createElement("div");return i.innerHTML="<svg/>",t=(i.firstChild&&i.firstChild.namespaceURI)==a,i.innerHTML="",t}(),p=function(){var t=document.createElement("div").style;return"transition"in t||"WebkitTransition"in t||"MozTransition"in t||"msTransition"in t||"OTransition"in t}(),l="ontouchstart"in window,h="mousedown"+(l?" touchstart":""),u="mousemove.clockpicker"+(l?" touchmove.clockpicker":""),d="mouseup.clockpicker"+(l?" touchend.clockpicker":""),k=navigator.vibrate?"vibrate":navigator.webkitVibrate?"webkitVibrate":null,m=0,v=135,f=110,b=80,g=20,w=2*v,y=p?350:1,A=['<div class="clockpicker picker">','<div class="picker__holder">','<div class="picker__frame">','<div class="picker__wrap">','<div class="picker__box">','<div class="picker__date-display">','<div class="clockpicker-display">','<div class="clockpicker-display-column">','<span class="clockpicker-span-hours text-primary"></span>',":",'<span class="clockpicker-span-minutes"></span>',"</div>",'<div class="clockpicker-display-column clockpicker-display-am-pm">','<div class="clockpicker-span-am-pm"></div>',"</div>","</div>","</div>",'<div class="picker__calendar-container">','<div class="clockpicker-plate">','<div class="clockpicker-canvas"></div>','<div class="clockpicker-dial clockpicker-hours"></div>','<div class="clockpicker-dial clockpicker-minutes clockpicker-dial-out"></div>',"</div>",'<div class="clockpicker-am-pm-block">',"</div>","</div>",'<div class="picker__footer">',"</div>","</div>","</div>","</div>","</div>","</div>"].join("");s.DEFAULTS={default:"",fromnow:0,donetext:"Done",autoclose:!1,ampmclickable:!1,darktheme:!1,twelvehour:!0,vibrate:!0},s.prototype.toggle=function(){this[this.isShown?"hide":"show"]()},s.prototype.locate=function(){var t=this.element,i=this.popover,e=t.offset(),s=t.outerWidth(),o=t.outerHeight(),c=this.options.align,n=this;i.show()},s.prototype.show=function(t){if(!this.isShown){o(this.options.beforeShow),$(":input").each(function(){$(this).attr("tabindex",-1)});var e=this;this.input.blur(),this.popover.addClass("picker--opened"),this.input.addClass("picker__input picker__input--active"),$(document.body).css("overflow","hidden"),this.isAppended||(this.popover.insertAfter(this.input),this.options.twelvehour&&(this.amOrPm="PM",this.options.ampmclickable?(this.spanAmPm.children("#click-pm").addClass("text-primary"),this.spanAmPm.children("#click-am").removeClass("text-primary")):(this.amPmBlock.children(".am-button").removeClass("active"),this.amPmBlock.children(".pm-button").addClass("active"),this.spanAmPm.empty().append("PM"))),c.on("resize.clockpicker"+this.id,function(){e.isShown&&e.locate()}),this.isAppended=!0);var s=((this.input.prop("value")||this.options.default||"")+"").split(":");if(this.options.twelvehour&&void 0!==s[1]&&(s[1]=s[1].replace("AM","").replace("PM","")),"now"===s[0]){var a=new Date(+new Date+this.options.fromnow);s=[a.getHours(),a.getMinutes()]}this.hours=+s[0]||0,this.minutes=+s[1]||0,this.spanHours.html(i(this.hours)),this.spanMinutes.html(i(this.minutes)),this.toggleView("hours"),this.locate(),this.isShown=!0,n.on("click.clockpicker."+this.id+" focusin.clockpicker."+this.id,function(t){var i=$(t.target);0===i.closest(e.popover.find(".picker__wrap")).length&&0===i.closest(e.input).length&&e.hide()}),n.on("keyup.clockpicker."+this.id,function(t){27===t.keyCode&&e.hide()}),o(this.options.afterShow)}},s.prototype.hide=function(){o(this.options.beforeHide),this.input.removeClass("picker__input picker__input--active"),this.popover.removeClass("picker--opened"),$(document.body).css("overflow","visible"),this.isShown=!1,$(":input").each(function(t){$(this).attr("tabindex",t+1)}),n.off("click.clockpicker."+this.id+" focusin.clockpicker."+this.id),n.off("keyup.clockpicker."+this.id),this.popover.hide(),o(this.options.afterHide)},s.prototype.toggleView=function(t,i){var e=!1;"minutes"===t&&"visible"===$(this.hoursView).css("visibility")&&(o(this.options.beforeHourSelect),e=!0);var s="hours"===t,c=s?this.hoursView:this.minutesView,n=s?this.minutesView:this.hoursView;this.currentView=t,this.spanHours.toggleClass("text-primary",s),this.spanMinutes.toggleClass("text-primary",!s),n.addClass("clockpicker-dial-out"),c.css("visibility","visible").removeClass("clockpicker-dial-out"),this.resetClock(i),clearTimeout(this.toggleViewTimer),this.toggleViewTimer=setTimeout(function(){n.css("visibility","hidden")},y),e&&o(this.options.afterHourSelect)},s.prototype.resetClock=function(t){var i=this.currentView,e=this[i],s="hours"===i,o=Math.PI/(s?6:30),c=e*o,n=s&&e>0&&e<13?b:f,a=Math.sin(c)*n,p=-Math.cos(c)*n,l=this;r&&t?(l.canvas.addClass("clockpicker-canvas-out"),setTimeout(function(){l.canvas.removeClass("clockpicker-canvas-out"),l.setHand(a,p)},t)):this.setHand(a,p)},s.prototype.setHand=function(t,e,s,o){var c=Math.atan2(t,-e),n="hours"===this.currentView,a=Math.PI/(n||s?6:30),p=Math.sqrt(t*t+e*e),l=this.options,h=n&&p<(f+b)/2,u=h?b:f,d;if(l.twelvehour&&(u=f),c<0&&(c=2*Math.PI+c),d=Math.round(c/a),c=d*a,l.twelvehour?n?0===d&&(d=12):(s&&(d*=5),60===d&&(d=0)):n?(12===d&&(d=0),d=h?0===d?12:d:0===d?0:d+12):(s&&(d*=5),60===d&&(d=0)),n?this.fg.setAttribute("class","clockpicker-canvas-fg"):d%5==0?this.fg.setAttribute("class","clockpicker-canvas-fg"):this.fg.setAttribute("class","clockpicker-canvas-fg active"),this[this.currentView]!==d&&k&&this.options.vibrate&&(this.vibrateTimer||(navigator[k](10),this.vibrateTimer=setTimeout($.proxy(function(){this.vibrateTimer=null},this),100))),this[this.currentView]=d,this[n?"spanHours":"spanMinutes"].html(i(d)),!r)return void this[n?"hoursView":"minutesView"].find(".clockpicker-tick").each(function(){var t=$(this);t.toggleClass("active",d===+t.html())});o||!n&&d%5?(this.g.insertBefore(this.hand,this.bearing),this.g.insertBefore(this.bg,this.fg),this.bg.setAttribute("class","clockpicker-canvas-bg clockpicker-canvas-bg-trans")):(this.g.insertBefore(this.hand,this.bg),this.g.insertBefore(this.fg,this.bg),this.bg.setAttribute("class","clockpicker-canvas-bg"));var m=Math.sin(c)*(u-g),v=-Math.cos(c)*(u-g),w=Math.sin(c)*u,y=-Math.cos(c)*u;this.hand.setAttribute("x2",m),this.hand.setAttribute("y2",v),this.bg.setAttribute("cx",w),this.bg.setAttribute("cy",y),this.fg.setAttribute("cx",w),this.fg.setAttribute("cy",y)},s.prototype.done=function(){o(this.options.beforeDone),this.hide(),this.label.addClass("active");var t=this.input.prop("value"),e=i(this.hours)+":"+i(this.minutes);this.options.twelvehour&&(e+=this.amOrPm),this.input.prop("value",e),e!==t&&(this.input.triggerHandler("change"),this.isInput||this.element.trigger("change")),this.options.autoclose&&this.input.trigger("blur"),o(this.options.afterDone)},s.prototype.remove=function(){this.element.removeData("clockpicker"),this.input.off("focus.clockpicker click.clockpicker"),this.isShown&&this.hide(),this.isAppended&&(c.off("resize.clockpicker"+this.id),this.popover.remove())},$.fn.pickatime=function(t){var i=Array.prototype.slice.call(arguments,1);return this.each(function(){var e=$(this),o=e.data("clockpicker");if(o)"function"==typeof o[t]&&o[t].apply(o,i);else{var c=$.extend({},s.DEFAULTS,e.data(),"object"==typeof t&&t);e.data("clockpicker",new s(e,c))}})}}();